@model TrocaBateriaWebApp.Models.Agendamento
@{
    ViewData["Title"] = "Detalhes do Agendamento";

    var statusClass = Model.Status switch
    {
        "Pendente" => "pending",
        "EmAndamento" => "in-progress",
        "Concluido" => "completed",
        "Cancelado" => "cancelled",
        _ => "default"
    };

    var statusTexto = Model.Status switch
    {
        "Pendente" => "Pendente",
        "EmAndamento" => "Em Andamento",
        "Concluido" => "Concluído",
        "Cancelado" => "Cancelado",
        _ => Model.Status
    };

    var statusIcon = Model.Status switch
    {
        "Pendente" => "fas fa-clock",
        "EmAndamento" => "fas fa-cog",
        "Concluido" => "fas fa-check-circle",
        "Cancelado" => "fas fa-times-circle",
        _ => "fas fa-info-circle"
    };
}
@section Styles {
    <link rel="stylesheet" href="~/css/agendamento.css" />
}

<div class="container mt-4">
    <div class="row justify-content-center">
        <div class="col-lg-10">
            <div class="details-card">
                <div class="details-header">
                    <div class="details-icon">
                        <i class="fas fa-calendar-check"></i>
                    </div>
                    <div class="details-title">
                        <h1>Agendamento #@Model.Id</h1>
                        <p>Detalhes completos do agendamento</p>
                    </div>
                    <div class="status-badge @statusClass">
                        <i class="@statusIcon"></i>
                        <span>@statusTexto</span>
                    </div>
                </div>

                <div class="details-body">
                    <div class="info-sections">
                        <!-- Seção Cliente -->
                        <div class="info-section">
                            <div class="section-header">
                                <i class="fas fa-user"></i>
                                <h3>Informações do Cliente</h3>
                            </div>
                            <div class="section-content">
                                <div class="info-grid">
                                    <div class="info-item">
                                        <div class="info-label">
                                            <i class="fas fa-user-tag"></i>
                                            Nome Completo
                                        </div>
                                        <div class="info-value">@Model.Usuario?.NomeCompleto</div>
                                    </div>
                                    <div class="info-item">
                                        <div class="info-label">
                                            <i class="fas fa-envelope"></i>
                                            E-mail
                                        </div>
                                        <div class="info-value">@Model.Usuario?.Email</div>
                                    </div>
                                    <div class="info-item">
                                        <div class="info-label">
                                            <i class="fas fa-phone"></i>
                                            Telefone
                                        </div>
                                        <div class="info-value">@(Model.Usuario?.Telefone ?? "Não informado")</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Seção Empresa -->
                        <div class="info-section">
                            <div class="section-header">
                                <i class="fas fa-building"></i>
                                <h3>Informações da Empresa</h3>
                            </div>
                            <div class="section-content">
                                <div class="info-grid">
                                    <div class="info-item">
                                        <div class="info-label">
                                            <i class="fas fa-building"></i>
                                            Nome da Empresa
                                        </div>
                                        <div class="info-value">@Model.Empresa?.NomeCompleto</div>
                                    </div>
                                    <div class="info-item">
                                        <div class="info-label">
                                            <i class="fas fa-envelope"></i>
                                            E-mail
                                        </div>
                                        <div class="info-value">@Model.Empresa?.Email</div>
                                    </div>
                                    <div class="info-item">
                                        <div class="info-label">
                                            <i class="fas fa-phone"></i>
                                            Telefone
                                        </div>
                                        <div class="info-value">@(Model.Empresa?.Telefone ?? "Não informado")</div>
                                    </div>
                                    <div class="info-item">
                                        <div class="info-label">
                                            <i class="fas fa-map-marker-alt"></i>
                                            Endereço
                                        </div>
                                        <div class="info-value">@(Model.Empresa?.Endereco ?? "Não informado")</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Seção Serviço -->
                        <div class="info-section">
                            <div class="section-header">
                                <i class="fas fa-car-battery"></i>
                                <h3>Detalhes do Serviço</h3>
                            </div>
                            <div class="section-content">
                                <div class="service-details">
                                    <div class="service-item">
                                        <div class="service-icon">
                                            <i class="fas fa-battery-full"></i>
                                        </div>
                                        <div class="service-info">
                                            <label>Tipo de Bateria</label>
                                            <span class="battery-type">@Model.TipoBateria</span>
                                        </div>
                                    </div>

                                    <div class="service-item full-width">
                                        <div class="service-icon">
                                            <i class="fas fa-sticky-note"></i>
                                        </div>
                                        <div class="service-info">
                                            <label>Observações</label>
                                            <div class="observations">
                                                @if (string.IsNullOrEmpty(Model.Observacoes))
                                                {
                                                    <span class="no-observations">Nenhuma observação</span>
                                                }
                                                else
                                                {
                                                    @Model.Observacoes
                                                }
                                            </div>
                                        </div>
                                    </div>

                                    <div class="timeline">
                                        <div class="timeline-item">
                                            <div class="timeline-icon">
                                                <i class="fas fa-calendar-plus"></i>
                                            </div>
                                            <div class="timeline-content">
                                                <label>Data de Criação</label>
                                                <span>@Model.DataAgendamento.ToString("dd/MM/yyyy 'às' HH:mm")</span>
                                            </div>
                                        </div>
                                        <div class="timeline-item">
                                            <div class="timeline-icon">
                                                <i class="fas fa-sync-alt"></i>
                                            </div>
                                            <div class="timeline-content">
                                                <label>Última Atualização</label>
                                                <span>@Model.DataAtualizacao.ToString("dd/MM/yyyy 'às' HH:mm")</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="action-footer">
                        @if (User.Identity!.IsAuthenticated)
                        {
                            var currentUser = await UserManager.GetUserAsync(User);
                            if (currentUser?.TipoConta == "Usuario")
                            {
                                <a asp-controller="Usuario" asp-action="MeusAgendamentos" class="btn btn-back">
                                    <i class="fas fa-arrow-left me-2"></i> Voltar aos Meus Agendamentos
                                </a>
                            }
                            else if (currentUser?.TipoConta == "Empresa")
                            {
                                <a asp-controller="Empresa" asp-action="Agendamentos" class="btn btn-back">
                                    <i class="fas fa-arrow-left me-2"></i> Voltar aos Agendamentos
                                </a>
                            }
                        }
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@using Microsoft.AspNetCore.Identity
@inject UserManager<TrocaBateriaWebApp.Models.ApplicationUser> UserManager